#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Найти город по имени.
// 
// Параметры:
//  НаименованиеУлицы - Строка - Наименование улицы в виде строки
//  Город - СправочникСсылка.ГородаДоставки - Город, в которм нужно найти улицу
//  ОператорДоставки - ПеречислениеСсылка.ОператорыДоставки - Оператор доставки
// 
// Возвращаемое значение:
// СправочникСсылка.Улицы, Строка - Ссылка на город доставки
//  
Функция НайтиУлицу(НаименованиеУлицы, Город, ОператорДоставки) Экспорт

	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	Улицы.Ссылка
		|ИЗ
		|	Справочник.Улицы КАК Улицы
		|ГДЕ
		|	Улицы.ОператорДоставки = &ОператорДоставки
		|	И (Улицы.Наименование = &НаименованиеУлицы)
		|	И Улицы.Город = &Город";
	
	Запрос.УстановитьПараметр("ОператорДоставки", ОператорДоставки);
	Запрос.УстановитьПараметр("НаименованиеУлицы", СокрЛП(НаименованиеУлицы));
	Запрос.УстановитьПараметр("Город", Город);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Если Выборка.Следующий() Тогда
		
		Результат = Выборка.Ссылка;
		
	Иначе
		
		Результат = НаименованиеУлицы;

	КонецЕсли;
	
	Возврат Результат;

КонецФункции
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытий
// Код процедур и функций
#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти

#КонецЕсли