////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ЗапретРедактированияРеквизитовОбъектов.ЗаблокироватьРеквизиты(ЭтотОбъект);
	
	УстановитьДоступность(ЭтотОбъект);
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ШАПКИ ФОРМЫ


&НаКлиенте
Процедура УказыватьПриПриемкеПриИзменении(Элемент)
	Если Не Объект.УказыватьПриПриемке Тогда
		
		Объект.УказыватьПриПриемкеКомплектующихПослеРазборки = Ложь;
		Объект.УказыватьПриПриемкеОтПоставщика               = Ложь;
		Объект.УказыватьПриПриемкеПоВозвратуОтКлиента        = Ложь;
		Объект.УказыватьПриПриемкеПоПеремещению              = Ложь;
		Объект.УказыватьПриПриемкеСобранныхКомплектов        = Ложь;
		
	КонецЕсли;
	
	УстановитьДоступность(ЭтотОбъект);
КонецПроцедуры

&НаКлиенте
Процедура УказыватьПриОтгрузкеПриИзменении(Элемент)
	Если Не Объект.УказыватьПриОтгрузке Тогда
		
		Объект.УказыватьПриОтгрузкеКлиенту                = Ложь;
		Объект.УказыватьПриОтгрузкеВРозницу               = Ложь;
		Объект.УказыватьПриОтгрузкеКомплектовДляРазборки  = Ложь;
		Объект.УказыватьПриОтгрузкеКомплектующихДляСборки = Ложь;
		Объект.УказыватьПриОтгрузкеПоВозвратуПоставщику   = Ложь;
		Объект.УказыватьПриОтгрузкеПоПеремещению          = Ложь;
		
		НастройкаУказанияСерийПриОтгрузке = 0;
	Иначе
		НастройкаУказанияСерийПриОтгрузке = 3;
	КонецЕсли;
	
	УстановитьДоступность(ЭтотОбъект);
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

// Обработчик команды, создаваемой механизмом запрета редактирования ключевых реквизитов.
//
&НаКлиенте
Процедура Подключаемый_РазрешитьРедактированиеРеквизитовОбъекта(Команда)
	
	Если Не Объект.Ссылка.Пустая() Тогда
		Результат = ОткрытьФормуМодально("Справочник.ПолитикиУчетаСерий.Форма.РазблокированиеРеквизитов");
		Если ТипЗнч(Результат) = Тип("Массив") И Результат.Количество() > 0 Тогда
			
			Если ЗапретРедактированияРеквизитовОбъектовКлиент.РазрешитьРедактированиеРеквизитовОбъекта(ЭтотОбъект) Тогда
				ЗапретРедактированияРеквизитовОбъектовКлиент.УстановитьДоступностьЭлементовФормы(ЭтотОбъект, Результат);
			КонецЕсли;
			
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

////////////////////////////////////////////////////////////////////////////////
// Прочее

&НаКлиентеНаСервереБезКонтекста
Процедура УстановитьДоступность(Форма)
	
	Форма.Элементы.УказыватьПриПриемкеПоВозвратуОтКлиента.Доступность        = Форма.Объект.УказыватьПриПриемке;
	Форма.Элементы.УказыватьПриПриемкеОтПоставщика.Доступность               = Форма.Объект.УказыватьПриПриемке;
	Форма.Элементы.УказыватьПриПриемкеПоПеремещению.Доступность              = Форма.Объект.УказыватьПриПриемке;
	Форма.Элементы.УказыватьПриПриемкеСобранныхКомплектов.Доступность        = Форма.Объект.УказыватьПриПриемке;
	Форма.Элементы.УказыватьПриПриемкеКомплектующихПослеРазборки.Доступность = Форма.Объект.УказыватьПриПриемке;
	
	Форма.Элементы.УказыватьПриОтгрузкеКлиенту.Доступность                = Форма.Объект.УказыватьПриОтгрузке;
	Форма.Элементы.УказыватьПриОтгрузкеВРозницу.Доступность               = Форма.Объект.УказыватьПриОтгрузке;
	Форма.Элементы.УказыватьПриОтгрузкеКомплектующихДляСборки.Доступность = Форма.Объект.УказыватьПриОтгрузке;
	Форма.Элементы.УказыватьПриОтгрузкеПоВозвратуПоставщику.Доступность   = Форма.Объект.УказыватьПриОтгрузке;
	Форма.Элементы.УказыватьПриОтгрузкеПоПеремещению.Доступность          = Форма.Объект.УказыватьПриОтгрузке;
	Форма.Элементы.УказыватьПриОтгрузкеКомплектовДляРазборки.Доступность  = Форма.Объект.УказыватьПриОтгрузке;
	
	Форма.Элементы.УказыватьПриОтраженииИзлишковНедостачПорчи.Доступность = Истина;
	Форма.Элементы.УказыватьПриПересчетеТоваров.Доступность               = Истина;
	Форма.Элементы.УказыватьПриПриемке.Доступность                        = Истина;
	Форма.Элементы.УказыватьПриОтгрузке.Доступность                       = Истина;
	
КонецПроцедуры

&НаСервере
Процедура ПослеЗаписиНаСервере(ТекущийОбъект, ПараметрыЗаписи)
	
	ЗапретРедактированияРеквизитовОбъектов.ЗаблокироватьРеквизиты(ЭтотОбъект);
	
КонецПроцедуры
