#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

//	LNK 08.11.2022 12:27:20
Функция ПолучитьПоНомеруМагазина(НомерМагазина)	Экспорт

	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	ПравилаЦенообразования.Ссылка КАК Правило
	|ИЗ
	|	Справочник.ПравилаЦенообразования КАК ПравилаЦенообразования
	|ГДЕ
	|	ПравилаЦенообразования.Наименование = &Наименование
	|	И НЕ ПравилаЦенообразования.ПометкаУдаления
	|	И ПравилаЦенообразования.Статус = ЗНАЧЕНИЕ(Перечисление.СтатусыПравилЦенообразования.Действует)"
	);
	Запрос.УстановитьПараметр("Наименование", "Правило цен № " + Формат(НомерМагазина, "ЧЦ=3; ЧДЦ=; ЧН=000; ЧВН="));
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда

			Правило = Выборка.Правило;

	Иначе	Правило = Справочники.ПравилаЦенообразования.СоздатьЭлемент();
			Правило.Наименование    = Запрос.Параметры.Наименование;
			Правило.ЦенаВключаетНДС = Истина;
			Правило.Статус = Перечисления.СтатусыПравилЦенообразования.Действует;
			Правило.ВидЦен = Справочники.ВидыЦен.ПолучитьПоНомеруМагазина(НомерМагазина);

			Правило.ОбменДанными.Загрузка = Истина;
			Правило.Записать();
			Правило = Правило.Ссылка;

	КонецЕсли;

	Возврат Правило;

КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции


#КонецОбласти
	
#КонецЕсли
