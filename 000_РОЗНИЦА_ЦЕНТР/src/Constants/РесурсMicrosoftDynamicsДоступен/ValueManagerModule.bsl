//	LNK 08.08.2019 13:46:00
Процедура ПередЗаписью(Отказ)

	Если ОбменДанными.Загрузка Тогда

		Возврат;

	КонецЕсли;

	ДополнительныеСвойства.Вставить("Значение", Константы.РесурсMicrosoftDynamicsДоступен.Получить());

КонецПроцедуры

//	LNK 08.08.2019 13:35:42
Процедура ПриЗаписи(Отказ)

	Если ОбменДанными.Загрузка Тогда

		Возврат;

	КонецЕсли;

	Если НЕ ДополнительныеСвойства.Свойство("СлужебнаяЗапись") Тогда

		Если НЕ Значение = ДополнительныеСвойства.Значение Тогда

			Если НЕ ПривилегированныйРежим() Тогда

				УстановитьПривилегированныйРежим(Истина);

			КонецЕсли;

			Константы.РесурсMicrosoftDynamicsРучноеОтключение.Установить(НЕ Значение);

			ЖурналСобытий.Регистрация("MSCRM.Доступность.РучноеОтключение"
			, ?(НЕ Значение, УровеньЖурналаРегистрации.Предупреждение, УровеньЖурналаРегистрации.Примечание)
			, Метаданные.Константы.РесурсMicrosoftDynamicsРучноеОтключение
			, НЕ Значение
			,
			, ?(НЕ Значение, "Контроль доступности ОТКЛЮЧЕН", "Контроль доступности возможен.")
			,, Истина);

		КонецЕсли;

	КонецЕсли;

КонецПроцедуры
