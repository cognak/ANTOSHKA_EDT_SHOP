#Область ОбработчикиОсновныхСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

//	Пропускаем инициализацию, чтобы гарантировать получение формы при передаче параметра "АвтоТест".
	Если Параметры.Свойство("АвтоТест") Тогда
		Возврат;
	КонецЕсли;

//	Обработчик механизма "ВерсионированиеОбъектов"
	ВерсионированиеОбъектов.ПриСозданииНаСервере(ЭтотОбъект);

	ОбщегоНазначенияРТ.ЗаполнитьШапкуДокумента(Объект,КартинкаСостоянияДокумента, СостояниеДокумента, РазрешеноПроведение);

	НастроитьФормуПоДополнительнымПравам();

	УправлениеДоступомРТ.ПриСозданииФормыНаСервере(ЭтотОбъект);	//	LNK 17.10.2019 14:30:01

КонецПроцедуры

&НаКлиенте
Процедура ПослеЗаписи(ПараметрыЗаписи)

	ОбщегоНазначенияРТКлиентСервер.ОбновитьСостояниеДокумента(Объект, СостояниеДокумента, КартинкаСостоянияДокумента, РазрешеноПроведение);

КонецПроцедуры
	
#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура КомментарийНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	ОбщегоНазначенияКлиент.ОткрытьФормуРедактированияКомментария(Элемент.ТекстРедактирования, Объект.Комментарий, Модифицированность);

КонецПроцедуры
	
#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура НастроитьФормуПоДополнительнымПравам()

	Если НЕ Объект.Магазин.Пустая() И НЕ ТехническаяПоддержкаВызовСервера.ИсключительныйРежим() Тогда

		ТекущийРегион = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Объект.Магазин, "ОбособленноеПодразделениеОрганизации");

		Если НЕ УправлениеПользователями.ДоступноЗначениеПраваДляТекущегоПользователя(
				"РазрешитьУстановкуЛимитовРучныхСкидокПоРегиону", ТекущийРегион) Тогда

			ТолькоПросмотр = Истина;
			Сообщить("Нет разрешения на работу с филиалом «" + ТекущийРегион + "»!");

		КонецЕсли;

	КонецЕсли;

КонецПроцедуры

#КонецОбласти



