#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

Функция ПолучитьЭНПоДокументуОснования(ДокументОснование) Экспорт
	
	СтруктураОтвета = Новый Структура;
	СтруктураОтвета.Вставить("ЕстьТТН", Ложь);
	СтруктураОтвета.Вставить("НомерТТН");
	СтруктураОтвета.Вставить("ПутьКФайлуСтикера");
	СтруктураОтвета.Вставить("ПутьКФайлуТТН");

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	ЭлектроннаяНакладная.Номер КАК НомерТТН,
		|	ЭлектроннаяНакладная.ПутьКФайлуСтикера КАК ПутьКФайлуСтикера,
		|	ЭлектроннаяНакладная.ПутьКФайлуТТН КАК ПутьКФайлуТТН
		|ИЗ
		|	Документ.ЭлектроннаяНакладная КАК ЭлектроннаяНакладная
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтатусыЭН.СрезПоследних КАК СтатусыЭНСрезПоследних
		|		ПО (СтатусыЭНСрезПоследних.ДокументРегистратор = ЭлектроннаяНакладная.Ссылка)
		|ГДЕ
		|	ЭлектроннаяНакладная.ДокументОснование = &Регистратор
		|	И НЕ СтатусыЭНСрезПоследних.СтатусЭН.СтатусПосылки = ЗНАЧЕНИЕ(Перечисление.СтатусыПосылокСлужбыДоставки.Отменена)";
	
	Запрос.УстановитьПараметр("Регистратор", ДокументОснование);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Если Выборка.Следующий() Тогда
		СтруктураОтвета.ЕстьТТН = Истина;
		СтруктураОтвета.НомерТТН = Выборка.НомерТТН;
		СтруктураОтвета.ПутьКФайлуСтикера = Выборка.ПутьКФайлуСтикера;
		СтруктураОтвета.ПутьКФайлуТТН = Выборка.ПутьКФайлуТТН;
	КонецЕсли;
	
	Возврат СтруктураОтвета;

КонецФункции

#КонецОбласти

#КонецЕсли