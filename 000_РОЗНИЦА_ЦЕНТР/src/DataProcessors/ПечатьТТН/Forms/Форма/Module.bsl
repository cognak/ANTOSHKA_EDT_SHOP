
///////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	// Пропускаем инициализацию, чтобы гарантировать получение формы при передаче параметра "АвтоТест".
	Если Параметры.Свойство("АвтоТест") Тогда
		Возврат;
	КонецЕсли;
	
	Если Параметры.Свойство("Документ") Тогда
		
		Объект.Документ = Параметры.Документ;
		
		Если ТипЗнч(Объект.Документ) = Тип("ДокументСсылка.РеализацияТоваров") Тогда
			
			Элементы.ВидЦен.АвтоОтметкаНезаполненного = Ложь;
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	ОтключитьОтметкуНезаполненного();

КонецПроцедуры

///////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ШАПКИ ФОРМЫ

&НаКлиенте
Процедура ДокументПриИзменении(Элемент)
	
	Если ТипЗнч(Объект.Документ) = Тип("ДокументСсылка.РеализацияТоваров") Тогда
		
		Элементы.ВидЦен.АвтоОтметкаНезаполненного = Ложь;
		
	Иначе
		
		Элементы.ВидЦен.АвтоОтметкаНезаполненного = Истина;
		
	КонецЕсли;	
	
	ОтключитьОтметкуНезаполненного();
	
КонецПроцедуры

///////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

&НаКлиенте
Процедура ПечатьТТН(Команда)
	
	Если ТипЗнч(Объект.Документ) = Тип("ДокументСсылка.ПеремещениеТоваров")
		И НЕ ЗначениеЗаполнено(Объект.ВидЦен) Тогда
		
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(НСтр("ru = 'Поле ""Вид цен"" не заполнено'"),,"Объект.ВидЦен");
		
	Иначе	
				
		ПараметрыПечати = Новый Структура;
		ПараметрыПечати.Вставить("МаркаАвтомобиля", Объект.МаркаАвтомобиля);
		ПараметрыПечати.Вставить("ГосНомерАвтомобиля", Объект.ГосНомерАвтомобиля);
		ПараметрыПечати.Вставить("ГосНомерПрицепа", Объект.ГосНомерПрицепа);
		ПараметрыПечати.Вставить("ПунктПогрузки", Объект.ПунктПогрузки);
		ПараметрыПечати.Вставить("ПунктРазгрузки", Объект.ПунктРазгрузки);
		ПараметрыПечати.Вставить("Водитель", Объект.Водитель);
		ПараметрыПечати.Вставить("Перевозчик", Объект.Перевозчик);
		ПараметрыПечати.Вставить("ВидПеревозки", Объект.ВидПеревозки);
		ПараметрыПечати.Вставить("ВидЦен", Объект.ВидЦен);
						
		ИмяМенеджераПечати = ?(ТипЗнч(Объект.Документ) = Тип("ДокументСсылка.ПеремещениеТоваров"),"Документ.ПеремещениеТоваров","Документ.РеализацияТоваров");
				
		УправлениеПечатьюКлиент.ВыполнитьКомандуПечати(ИмяМенеджераПечати,
				"ТТН",
				Объект.Документ,
				ЭтотОбъект,
				ПараметрыПечати);
		
	КонецЕсли;
	
КонецПроцедуры

///////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ
