&НаСервере	//	LNK 29.01.2019 14:37:24
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

	Элементы.Объект.ТолькоПросмотр = ЗначениеЗаполнено(Запись.Объект);

	УстановитьДанныеПредставление();

КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)

	Если ТекущийОбъект.МоментСоздания = '00010101' И НЕ ТекущийОбъект.Объект = Неопределено Тогда

		ТекущийОбъект.МоментСоздания = ОбщегоНазначенияКлиентСервер.УникальныйИдентификаторВремя(ТекущийОбъект.Объект.УникальныйИдентификатор());

	КонецЕсли;

КонецПроцедуры

&НаСервере	//	LNK 18.11.2019 10:12:01
Процедура УстановитьДанныеПредставление()

	Элементы.ДанныеПредставление.Видимость = Ложь;

	Если ЗначениеЗаполнено(Запись.Объект) Тогда

		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаРегистра.Данные КАК Данные
		|ИЗ
		|	РегистрСведений.ОбъектыПроблемныеДоВыяснения КАК ТаблицаРегистра
		|ГДЕ
		|	ТаблицаРегистра.Период = &Период
		|	И ТаблицаРегистра.Объект = &Объект
		|	И ТаблицаРегистра.Магазин = &Магазин"
		);
		Запрос.УстановитьПараметр("Период", Запись.ИсходныйКлючЗаписи.Период);
		Запрос.УстановитьПараметр("Объект", Запись.ИсходныйКлючЗаписи.Объект);
		Запрос.УстановитьПараметр("Магазин", Запись.ИсходныйКлючЗаписи.Магазин);
		
		Выборка = Запрос.Выполнить().Выбрать();
		
		Если Выборка.Следующий() Тогда

			ЗначениеДанных = Выборка.Данные.Получить();

			Если ТипЗнч(ЗначениеДанных) = Тип("Структура") И НЕ ЗначениеДанных.Количество() = 0 Тогда

				Элементы.ДанныеПредставление.Видимость = Истина;

				ДанныеПредставление = ОбщегоНазначенияКлиентСервер.СтруктураПредставление("Хранимые Данные", ЗначениеДанных);

			КонецЕсли;

		КонецЕсли;

	КонецЕсли;

КонецПроцедуры
