&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

	ДокументСсылка = Параметры.ДокументСсылка;

	РеквизитыСсылки = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(ДокументСсылка, "Номер, Дата, Комментарий");

	Для каждого КлючЗначение Из РеквизитыСсылки Цикл

		ЭтотОбъект[КлючЗначение.Ключ] = КлючЗначение.Значение;

	КонецЦикла;

	Элементы.ГруппаНомерДата.Заголовок = ДокументСсылка.Метаданные().Синоним;

КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)


КонецПроцедуры

//	\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\/

&НаСервере
Процедура ЗаписатьИЗакрытьНаСервере()

	Если НЕ ПривилегированныйРежим() Тогда

		УстановитьПривилегированныйРежим(Истина);

	КонецЕсли;

	ДокументОбъект = ДокументСсылка.ПолучитьОбъект();
	ДокументОбъект.Комментарий = СокрЛП(Комментарий);

	ДокументОбъект.ОбменДанными.Загрузка = Истина;
	ДокументОбъект.ДополнительныеСвойства.Вставить("ПропуститьПроверкуЗапретаИзменения", Истина);
	ДокументОбъект.Записать();

КонецПроцедуры

&НаКлиенте
Процедура ЗаписатьИЗакрыть(Команда)

	ЗаписатьИЗакрытьНаСервере();
	ПоказатьОповещениеПользователя("Изменения записаны", ПолучитьНавигационнуюСсылку(ДокументСсылка)
		, "Сделанные изменения внесены в документ «" + ДокументСсылка + "» и документ записан.", БиблиотекаКартинок.Предупреждение32);
	Закрыть();

КонецПроцедуры
